<?xml version="1.0" encoding="UTF-8"?>
<Patch>

    <Operation Class="PatchOperationRemove">
        <xpath>/Defs/ThingDef[defName = "PPCObelisk"]/costStuffCount</xpath>
    </Operation>

    <Operation Class="PatchOperationRemove">
        <xpath>/Defs/ThingDef[@Name = "BasedWeapon"]/constructEffect</xpath>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>/Defs/ThingDef[@ParentName = "BasedWeapon"]/comps/li[@Class = "Rimatomics.CompProperties_Upgradable"]/../..</xpath>
        <value>
            <stuffCategories><li>Metallic</li></stuffCategories><costStuffCount>10</costStuffCount>
        </value>
    </Operation>

    <!-- Edits specific to Tesla Coil -->
    <Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
            <li Class="PatchOperationTest">
                <xpath>/Defs/ThingDef[defName = "PPCTeslaCoil"]/graphicData/shaderType</xpath>
                <success>Invert</success>
            </li>
            <li Class="PatchOperationAdd">
                <xpath>/Defs/ThingDef[defName = "PPCTeslaCoil"]/graphicData</xpath>
                <value>
                    <shaderType>CutoutComplex</shaderType>
                </value>
            </li>
        </operations>
    </Operation>

    <!-- Modify base costs for steel and components -->
    <Operation Class="PatchOperationSequence">
        <success>Always</success>
        <operations>
            <li Class="PatchOperationReplace">
                <xpath>*/ThingDef[defName = "PPC" or defName = "PPCHEL" or defName = "PPCObelisk"]/costList/Steel</xpath>
                <value>
                    <Steel>300</Steel>
                </value>
            </li>
            <li Class="PatchOperationReplace">
                <xpath>*/ThingDef[defName = "PPCADS" or defName = "PPCTeslaCoil"]/costList/Steel</xpath>
                <value>
                    <Steel>125</Steel>
                </value>
            </li>
            <li Class="PatchOperationReplace">
                <xpath>*/ThingDef[defName = "PPC" or defname = "PPCObelisk"]/costList/Component</xpath>
                <value>
                    <Component>5</Component>
                </value>
            </li>
            <li Class="PatchOperationReplace">
                <xpath>*/ThingDef[defName = "PPCHEL"]/costList/Component</xpath>
                <value>
                    <Component>4</Component>
                </value>
            </li>
            <li Class="PatchOperationReplace">
                <xpath>*/ThingDef[defName = "PPCADS" or defname = "PPCTeslaCoil"]/costList/Component</xpath>
                <value>
                    <Component>3</Component>
                </value>
            </li>
        </operations>
    </Operation>

    <!-- Add VG recipes to Self Cooker -->
    <Operation Class="PatchOperationSequence">
		<success>Always</success>
		<operations>
            <li Class="ModCheck.isModLoaded">
                <modName>VGP Garden Gourmet</modName>
                <yourMod>Rimatomics: Better Weapons</yourMod>
                <errorOnFail>false</errorOnFail>
            </li>
            <li Class="PatchOperationAdd">
                <xpath>/Defs/ThingDef[thingClass = "ProjectRimFactory.SAL3.Things.Assemblers.Building_SimpleAssembler"]/recipes</xpath>
                <value>
                    <li>CraftFlour</li>
                    <li>GroundSugar</li>
                    <li>CraftCornmeal</li>
                    <li>Makesoycheese</li>
                    <li>Maketofu</li>
                    <li>MakePolenta</li>
                    <li>BakeBread</li>
                    <li>CraftChocolate</li>
                </value>
            </li>
        </operations>
    </Operation>

</Patch>